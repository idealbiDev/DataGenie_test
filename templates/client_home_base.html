<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Enhanced Dashboard with Dark Mode</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link
  
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    integrity="sha512-..."
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <style>
    .db-icon {
            font-size: 24px;
            margin-right: 10px;
            vertical-align: middle;
        }
        .db-card {
            cursor: pointer;
            transition: all 0.3s;
            height: 100%;
        }
        .db-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .connection-form .form-group {
            margin-bottom: 1.5rem;
        }
    .step-indicator {
    display: flex;
    justify-content: center;
    margin-bottom: 1rem; /* was 2rem */
}
.step {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0 0.5rem; /* was 1rem */
    font-size: 0.7rem; /* shrink step label text */
}
.step-number {
    width: 20px;       /* was 40px */
    height: 20px;      /* was 40px */
    border-radius: 50%;
    background-color: #e9ecef;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.25rem; /* was 0.5rem */
    font-weight: bold;
    font-size: 0.65rem; /* shrink number text */
}
.step.active .step-number {
    background-color: #0d6efd;
    color: white;
}
.step.completed .step-number {
    background-color: #198754;
    color: white;
}

    .arrow-icon {
      transition: transform 0.2s ease-in-out;
    }
    .arrow-icon.rotate-90 {
      transform: rotate(90deg);
    }
    .sidebar-item {
      transition: all 0.2s ease;
    }
    .sidebar-item:hover {
      background-color: #f3f4f6;
    }
    .dark .sidebar-item:hover {
      background-color: #374151;
    }
    .active {
      background-color: #e5e7eb;
      border-left: 4px solid #3b82f6;
    }
    .dark .active {
      background-color: #374151;
      border-left: 4px solid #60a5fa;
    }
    
    /* Custom styles for dark mode */
    .dark {
      background-color: #111827;
      color: #f3f4f6;
    }
    .dark .header-dark {
      background-color: #1f2937;
      color: #f9fafb;
      border-bottom: 1px solid #374151;
    }
    .dark .sidebar-dark {
      background-color: #1f2937;
      color: #f9fafb;
      border-right: 1px solid #374151;
    }
    .dark .main-dark {
      background-color: #111827;
    }
    .dark .card-dark {
      background-color: #1f2937;
      color: #f3f4f6;
      border: 1px solid #374151;
    }
    .dark .text-dark {
      color: #f3f4f6;
    }
    .dark .border-dark {
      border-color: #374151;
    }
    .dark .hover-dark:hover {
      background-color: #374151;
    }
    
    /* Smooth transition for theme switching */
    body, header, aside, .card, button, main {
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    
    /* Toggle switch styling */
    .theme-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 28px;
    }
    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #1f2937;
      transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #f3f4f6;
    }
    input:checked + .slider:before {
      transform: translateX(32px);
    }
    
    /* Flexbox container for the full viewport height content */
    html, body, .dashboard-container {
        height: 100%;
    }

    .dashboard-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    
    /* Main content wrapper to take up the remaining height */
    .content-wrapper {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    /* Sidebar and main content to fill the remaining height */
    .sidebar {
      height: 100%;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .main-content {
      flex: 1;
      height: 100%;
      overflow-y: auto;
    }

    /* Footer to push to the bottom of the sidebar */
    .sidebar-footer {
      margin-top: auto;
    }
    
    /* Expandable content - show by default */
    .expandable-content {
      display: block;
    }
    
    /* Custom scrollbar for sidebar */
    .sidebar::-webkit-scrollbar {
      width: 6px;
    }
    .sidebar::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }
    .sidebar::-webkit-scrollbar-thumb {
      background: #c5c5c5;
      border-radius: 10px;
    }
    .sidebar::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    .dark .sidebar::-webkit-scrollbar-track {
      background: #374151;
    }
    .dark .sidebar::-webkit-scrollbar-thumb {
      background: #6b7280;
    }
    .dark .sidebar::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }
    
    /* Brand styling */
    .brand-text {
      font-weight: bold;
      font-size: 1.25rem;
    }
    .brand-data {
      color: #c0c0c0; /* Silver-gray color */
    }
    .brand-genie {
      color: #ffa500; /* Orange color */
    }
    
    /* Relationship Builder Styles */
    .step {
      display: none;
      padding: 1.25rem;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      margin-bottom: 1.25rem;
      background: #f9fafb;
    }
    .dark .step {
      background: #1f2937;
      border-color: #374151;
    }
    .step.active {
      display: block;
    }
    .database-item, .schema-item, .table-item {
      padding: 0.625rem;
      margin: 0.25rem 0;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.25rem;
      cursor: pointer;
    }
    .dark .database-item, .dark .schema-item, .dark .table-item {
      background: #374151;
      border-color: #4b5563;
    }
    .database-item:hover, .schema-item:hover, .table-item:hover {
      background: #f3f4f6;
    }
    .dark .database-item:hover, .dark .schema-item:hover, .dark .table-item:hover {
      background: #4b5563;
    }
    .database-item.selected, .schema-item.selected, .table-item.selected {
      background: #3b82f6;
      color: white;
      border-color: #2563eb;
    }
    .relationship-builder {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 1.25rem;
      align-items: end;
      margin: 1.25rem 0;
      padding: 1.25rem;
      background: white;
      border-radius: 0.5rem;
      border: 1px solid #e5e7eb;
    }
    .dark .relationship-builder {
      background: #1f2937;
      border-color: #374151;
    }
    .saved-relationship {
      padding: 0.625rem;
      margin: 0.25rem 0;
      background: #d1fae5;
      border: 1px solid #a7f3d0;
      border-radius: 0.25rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .dark .saved-relationship {
      background: #065f46;
      border-color: #047857;
    }
    .loading {
      display: none;
      text-align: center;
      padding: 1.25rem;
    }
    .qualified-name {
      font-family: monospace;
      background: #f9fafb;
      padding: 0.125rem 0.375rem;
      border-radius: 0.125rem;
      border: 1px solid #e5e7eb;
    }
    .dark .qualified-name {
      background: #374151;
      border-color: #4b5563;
    }
  </style>
</head>
<body class="bg-gray-100 font-sans">
  <div class="dashboard-container">
    <header class="header-dark h-[5vh] bg-blue-700 text-white flex items-center justify-between px-4 z-50 shadow-md">
      <div class="flex items-center space-x-2">
        <img src="https://via.placeholder.com/24" class="h-6 w-6" alt="Logo" />
        <span class="brand-text">
          <span class="brand-data">Data</span>
          <span class="brand-genie">Genie</span>
        </span>
      </div>
      <div class="flex items-center space-x-4 relative">
        <button title="Notifications" class="hover:text-blue-200 transition-colors"><i class="fas fa-bell"></i></button>
        <button title="Messages" class="hover:text-blue-200 transition-colors"><i class="fas fa-envelope"></i></button>
        <button title="Settings" class="hover:text-blue-200 transition-colors"><i class="fas fa-cog"></i></button>
        <button id="profile-toggle" title="User Profile" class="hover:text-blue-200 transition-colors"><i class="fas fa-user-circle"></i></button>
       
        <a href="{{ url_for('logout') }}" class="logout-button" title="Log Out">
          <i class="fas fa-sign-out-alt"></i>
        </a>
        
        <div id="profile-dropdown" class="absolute hidden right-0 top-full mt-2 w-64 bg-white rounded-lg shadow-xl dark:bg-gray-800 dark:border-gray-700 z-50">
          <div class="p-4 border-b dark:border-gray-700">
            <p class="text-sm font-semibold text-gray-800 dark:text-gray-200">John Doe</p>
            <p class="text-xs text-gray-500 dark:text-gray-400">john.doe@example.com</p>
          </div>
          <div class="p-4 flex items-center justify-between">
            <span class="text-gray-700 dark:text-gray-300">Dark Mode</span>
            <label class="theme-switch">
              <input type="checkbox" id="theme-toggle">
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>
    </header>

    <button
      class="md:hidden fixed top-[5vh] left-2 z-40 bg-blue-600 text-white p-2 rounded-full shadow-lg transition-all hover:bg-blue-800"
      id="menu-toggle"
    >
      <i class="fas fa-bars"></i>
    </button>

    <div class="content-wrapper">
      <aside
        id="sidebar"
        class="sidebar sidebar-dark bg-white w-64 p-4 shadow-md transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out z-40 md:sticky md:top-0"
      >
        <h2 class="text-xl font-semibold mb-4 pl-2 dark:text-white">{{session["company_name"]}}</h2>
        <h4 class="text-sm font-semibold text-black">
          Server: 
          <span class="text-blue-600 font-bold">
           {{ session["server"] }}
          </span>
        </h4>
		
        <ul class="space-y-1">
          <li>
            <a href="#" class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded sidebar-item dark:text-gray-300 dark:hover:bg-gray-700">
              <i class="fas fa-tachometer-alt w-5 mr-3 text-blue-500"></i>
              <span>Dashboard</span>
            </a>
          </li>
          
          <li>
            <div class="flex justify-between items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer rounded expandable-toggle sidebar-item dark:text-gray-300 dark:hover:bg-gray-700">
              <div class="flex items-center">
                <i class="fas fa-cogs w-5 mr-3 text-blue-500"></i>
                <span class="font-bold uppercase">SERVICES</span>
              </div>
              <span class="arrow-icon rotate-90">&#9658;</span>
            </div>
            <ul class="ml-4 mt-1 space-y-1 expandable-content">
               {% for po in session["products_opted"] %}
            {% set  display ,link = po.split('-') %}
            
            <li><a href="" class="flex items-center px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded dark:text-gray-400 dark:hover:bg-gray-700 dark:border-dark border-b border-gray-200"><i class="fas fa-cube w-4 mr-2 text-blue-400"></i>{{ display }}</a></li>
          {% endfor %}
   </ul>
          </li>
          <li>
            <div class="flex justify-between items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer rounded expandable-toggle sidebar-item dark:text-gray-300 dark:hover:bg-gray-700">
              <div class="flex items-center">
                <i class="fas fa-plug w-5 mr-3 text-blue-500"></i>
                <span class="font-bold uppercase">CONNECTIONS</span>
              </div>
              <span class="arrow-icon rotate-90">&#9658;</span>
            </div>
            <ul class="ml-4 mt-1 space-y-1 expandable-content">
              <li><a href="" class="flex items-center px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded dark:text-gray-400 dark:hover:bg-gray-700"><i class="fas fa-plus w-4 mr-2 text-blue-400"></i>Add Connection</a></li>
            
            </ul>
          </li>
          
          
        </ul>
      </aside>

      <main class="main-content main-dark pl-2 pr-6 py-6 bg-gray-50 dark:bg-gray-900">
       <div class="flex items-center gap-4">
  <i class="fas fa-database text-blue-600 text-3xl"></i>
  <h1 class="text-2xl font-bold">{{ product }}</h1>
</div>
        <hr class="border-t border-gray-300 mb-6 dark:border-gray-700">
        
               {% block content %}
      {% endblock %}
      
      </main>
    </div>
  </div>

  <script>
    // Sidebar expand toggle
    document.querySelectorAll('.expandable-toggle').forEach((toggle) => {
      toggle.addEventListener('click', function () {
        const content = this.nextElementSibling;
        const arrow = this.querySelector('.arrow-icon');
        if (content) {
          content.classList.toggle('hidden');
          arrow.classList.toggle('rotate-90');
        }
      });
    });

    // Mobile sidebar toggle
    const menuToggle = document.getElementById('menu-toggle');
    const sidebar = document.getElementById('sidebar');
    menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('-translate-x-full');
    });
    
    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth < 768 && 
          !sidebar.contains(e.target) && 
          e.target !== menuToggle && 
          !menuToggle.contains(e.target)) {
        sidebar.classList.add('-translate-x-full');
      }
    });

    // Theme toggle functionality
    const themeToggle = document.getElementById('theme-toggle');
    
    if (localStorage.getItem('theme') === 'dark' || 
        (window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('theme'))) {
      document.documentElement.classList.add('dark');
      themeToggle.checked = true;
    }
    
    themeToggle.addEventListener('change', () => {
      if (themeToggle.checked) {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      } else {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      }
    });

    // Profile Dropdown Toggle
    const profileToggle = document.getElementById('profile-toggle');
    const profileDropdown = document.getElementById('profile-dropdown');

    profileToggle.addEventListener('click', (event) => {
      event.stopPropagation(); // Prevents the document click listener from immediately closing the dropdown
      profileDropdown.classList.toggle('hidden');
    });

    // Close the dropdown when clicking anywhere else on the document
    document.addEventListener('click', (event) => {
      if (!profileDropdown.contains(event.target) && !profileToggle.contains(event.target)) {
        profileDropdown.classList.add('hidden');
      }
    });

  </script>
</body>
</html>